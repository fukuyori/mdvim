# mdvim チュートリアル

このチュートリアルでは、mdvimの基本的な使い方から高度な機能まで、順を追って解説します。

## 目次

1. [はじめに](#はじめに)
2. [モードを理解する](#モードを理解する)
3. [基本的な編集](#基本的な編集)
4. [移動](#移動)
5. [検索と置換](#検索と置換)
6. [ファイル操作](#ファイル操作)
7. [Markdown機能](#markdown機能)
8. [画像の扱い](#画像の扱い)
9. [高度な機能](#高度な機能)
10. [ヒントとコツ](#ヒントとコツ)

---

## はじめに

### 最初の画面

mdvimを開くと、以下のような画面が表示されます：

```
+------------------+------------------+------------------+
|     行番号       |    エディタ      |   プレビュー     |
|                  |                  |                  |
|        1         | （カーソル位置） |                  |
|        2         |                  |                  |
|        3         |                  |                  |
+------------------+------------------+------------------+
|  NORMAL          |  無題            |  Ln 1, Col 1     |
+------------------+------------------+------------------+
```

画面構成：
- **左**: 行番号
- **中央**: エディタペイン（入力場所）
- **右**: ライブプレビューペイン
- **下**: ステータスバー（モード、ファイル名、カーソル位置）

### ステータスバー

ステータスバーには重要な情報が表示されます：
- **モード表示**: NORMAL、INSERT、VISUAL、COMMAND
- **ファイル名**: 現在のファイル名（または「無題」）
- **カーソル位置**: 行番号とカラム番号
- **変更表示**: 未保存の変更がある場合は`[+]`が表示

---

## モードを理解する

mdvimにはVimと同様に4つのモードがあります：

### ノーマルモード（デフォルト）

起動時のモードです。ノーマルモードでは：
- キー入力はテキストではなくコマンドとして扱われる
- 移動、削除、コピー、ペーストなどの操作が可能
- `i`キーでインサートモードへ
- `:`キーでコマンドモードへ
- `v`キーでビジュアルモードへ

### インサートモード

テキストを入力するモードです：
- 通常のエディタと同じように入力可能
- `Esc`キーでノーマルモードに戻る
- ステータスバーに`INSERT`と表示

### ビジュアルモード

テキストを選択するモードです：
- カーソル移動で選択範囲を広げる
- 選択範囲にコマンドを適用可能
- `Esc`キーでキャンセル
- ステータスバーに`VISUAL`と表示

### コマンドモード

Exコマンドを入力するモードです：
- ノーマルモードで`:`を押して入る
- コマンドを入力してEnterで実行
- ステータスバーに`COMMAND`と表示

### モード遷移図

```
                    i, a, o, O
        ┌─────────────────────────┐
        │                         ▼
    NORMAL ◄──────────────── INSERT
        │         Esc             
        │                         
        │ v, V                    
        │         Esc             
        ▼─────────────────────────►
    VISUAL                        

        : (コロン)    Enter/Esc
    NORMAL ──────► COMMAND ──────► NORMAL
```

---

## 基本的な編集

### インサートモードに入る

| キー | 動作 | 覚え方 |
|-----|--------|----------|
| `i` | カーソルの前に挿入 | **i**nsert |
| `a` | カーソルの後に挿入 | **a**ppend |
| `I` | 行頭に挿入 | |
| `A` | 行末に挿入 | |
| `o` | 下に行を追加して挿入 | **o**pen |
| `O` | 上に行を追加して挿入 | |

### 例：最初のドキュメントを書く

1. `i`キーでインサートモードに入る
2. `# 最初のドキュメント`と入力
3. `Enter`を2回押す
4. `これは最初の段落です。`と入力
5. `Esc`キーでノーマルモードに戻る

ドキュメントは以下のようになります：
```markdown
# 最初のドキュメント

これは最初の段落です。
```

プレビューにはフォーマットされた状態で表示されます！

### テキストの削除

| キー | 動作 |
|-----|--------|
| `x` | カーソル位置の文字を削除 |
| `X` | カーソル前の文字を削除 |
| `dd` | 行全体を削除 |
| `dw` | 単語を削除 |
| `d$` または `D` | 行末まで削除 |
| `d0` | 行頭まで削除 |

### コピーとペースト

| キー | 動作 |
|-----|--------|
| `yy` | 現在行をヤンク（コピー） |
| `yw` | 単語をヤンク |
| `y$` | 行末までヤンク |
| `p` | カーソルの後にペースト |
| `P` | カーソルの前にペースト |

### 元に戻す・やり直し

| キー | 動作 |
|-----|--------|
| `u` | 元に戻す |
| `Ctrl+r` | やり直し |
| `.` | 直前の変更を繰り返す |

### 練習問題

以下の操作を試してみましょう：
1. `i`を押して`Hello World`と入力し、`Esc`を押す
2. `yy`で行をコピー
3. `p`で下にペースト
4. `dd`でペーストした行を削除
5. `u`で削除を元に戻す

---

## 移動

### 基本の移動

```
         k
         ↑
    h ←     → l
         ↓
         j
```

| キー | 動作 |
|-----|--------|
| `h` | 左に移動 |
| `j` | 下に移動 |
| `k` | 上に移動 |
| `l` | 右に移動 |

**ヒント**: 矢印キーも使えますが、`hjkl`ならホームポジションから手を離さずに操作できます。

### 単語単位の移動

| キー | 動作 |
|-----|--------|
| `w` | 次の単語の先頭へ |
| `b` | 前の単語の先頭へ |
| `e` | 現在/次の単語の末尾へ |
| `ge` | 前の単語の末尾へ |

### 行内の移動

| キー | 動作 |
|-----|--------|
| `0` | 行頭へ |
| `^` | 最初の非空白文字へ |
| `$` | 行末へ |

### ドキュメント内の移動

| キー | 動作 |
|-----|--------|
| `gg` | 最初の行へ |
| `G` | 最後の行へ |
| `{数字}G` | 指定行へ |
| `H` | 画面上部へ |
| `M` | 画面中央へ |
| `L` | 画面下部へ |

### スクロール

| キー | 動作 |
|-----|--------|
| `Ctrl+f` | ページダウン |
| `Ctrl+b` | ページアップ |
| `Ctrl+d` | 半ページダウン |
| `Ctrl+u` | 半ページアップ |
| `zz` | カーソルを画面中央に |
| `zt` | カーソルを画面上部に |
| `zb` | カーソルを画面下部に |

### カウントの使用

多くのコマンドはカウント（回数）を受け付けます：
- `5j` - 5行下に移動
- `3w` - 3単語先に移動
- `10G` - 10行目に移動
- `2dd` - 2行削除

---

## 検索と置換

### 基本の検索

| キー | 動作 |
|-----|--------|
| `/パターン` | 前方検索 |
| `?パターン` | 後方検索 |
| `n` | 次のマッチへ |
| `N` | 前のマッチへ |
| `*` | カーソル下の単語を前方検索 |
| `#` | カーソル下の単語を後方検索 |

### 検索の例

1. `/`を押して検索を開始
2. `markdown`と入力してEnter
3. `n`で次のマッチへ移動
4. `N`で前のマッチへ移動
5. `:noh`でハイライトを解除

### 文字検索

| キー | 動作 |
|-----|--------|
| `f{文字}` | 文字を前方検索 |
| `F{文字}` | 文字を後方検索 |
| `t{文字}` | 文字の直前まで移動（前方） |
| `T{文字}` | 文字の直後まで移動（後方） |
| `;` | 直前のf/F/t/Tを繰り返す |
| `,` | 直前のf/F/t/Tを逆方向に繰り返す |

### 検索のヒント

- 検索はデフォルトで大文字/小文字を区別します
- 全角文字も`f`で検索できます（例：`fあ`）
- 数字も検索可能です（例：`f4`で「4」を検索）

---

## ファイル操作

### 基本的なファイル操作

| コマンド | 動作 |
|---------|--------|
| `:w` | 現在のファイルを保存 |
| `:w ファイル名` | 名前を付けて保存 |
| `:e ファイル名` | ファイルを開く |
| `:new` | 新規ファイル作成 |
| `:q` | 終了 |
| `:q!` | 保存せずに終了 |
| `:wq` | 保存して終了 |

### キーボードショートカット

| ショートカット | 動作 |
|----------|--------|
| `Ctrl+S` | 保存 |
| `Ctrl+O` | ファイルを開くダイアログ |
| `Ctrl+N` | 新規ファイル |

### エクスポートオプション

| コマンド | 形式 |
|---------|--------|
| `:export md` | Markdown（画像があれば`.mdvim` ZIP） |
| `:export html` | 画像埋め込みのスタンドアロンHTML |

### URLからインポート

```vim
:import https://example.com/document.md
```

対応プラットフォーム：
- Qiitaの記事
- GitHubのファイル
- GitHub Gist
- 直接の`.md` URL

---

## Markdown機能

### 対応構文

mdvimは標準的なMarkdownに対応しています：

```markdown
# 見出し1
## 見出し2
### 見出し3

**太字** と *斜体* と ~~取り消し線~~

- 箇条書き
- 項目2
  - ネストした項目

1. 番号付きリスト
2. 項目2

> 引用

`インラインコード`

​```javascript
// コードブロック
const x = 1;
​```

[リンク](https://example.com)

![画像](image.png)

| テーブル | ヘッダー |
|---------|--------|
| セル    | セル   |
```

### ライブプレビュー

右ペインにはMarkdownがリアルタイムでレンダリングされます：
- エディタとプレビューのスクロールは同期
- プレビューをクリックするとエディタにフォーカス
- `Ctrl+P`でプレビューの表示/非表示を切り替え

### 目次（TOC）

- 見出しから自動生成
- クリックで該当箇所にジャンプ
- 矢印クリックでセクションを折りたたみ
- `Ctrl+Shift+T`で表示/非表示を切り替え

---

## 画像の扱い

### 画像の追加

**方法1: ドラッグ＆ドロップ**
1. ファイルエクスプローラーから画像をドラッグ
2. エディタ上にドロップ
3. Markdown画像構文が自動挿入される

**方法2: クリップボードからペースト**
1. 画像をコピー（スクリーンショットなど）
2. インサートモードで`Ctrl+V`
3. 画像が埋め込まれ、構文が挿入される

**方法3: 手動で構文を書く**
```markdown
![代替テキスト](https://example.com/image.png)
```

### 画像の保存

画像はBase64データとしてドキュメント内に保存されます。エクスポート時：
- `:export md` - Markdownと画像を含む`.mdvim` ZIPファイルを作成
- `:export html` - 画像が埋め込まれたスタンドアロンHTMLを作成

---

## 高度な機能

### ビジュアルモードの操作

1. `v`でビジュアルモードに入る
2. カーソルを動かして選択
3. 操作を適用：

| キー | 動作 |
|-----|--------|
| `d` | 選択範囲を削除 |
| `y` | 選択範囲をヤンク |
| `>` | 選択範囲をインデント |
| `<` | 選択範囲をデデント |
| `~` | 大文字/小文字を切り替え |

### マクロ

コマンドの連続を記録して再生：

| キー | 動作 |
|-----|--------|
| `q{a-z}` | マクロの記録を開始（レジスタに保存） |
| `q` | 記録を停止 |
| `@{a-z}` | マクロを再生 |
| `@@` | 直前のマクロを繰り返す |

**例**: 各行の先頭に`- `を追加するマクロ：
1. `qa` - レジスタ'a'への記録を開始
2. `I- Esc j` - 行頭に"- "を挿入、次の行へ
3. `q` - 記録を停止
4. `5@a` - 5回繰り返す

### マーク

ドキュメント内にブックマークを設定：

| キー | 動作 |
|-----|--------|
| `m{a-z}` | マークを設定 |
| `` `{a-z} `` | マークへジャンプ（正確な位置） |
| `'{a-z}` | マークへジャンプ（行頭） |

### レジスタ

名前付きレジスタで複数のクリップボードを使用：

| キー | 動作 |
|-----|--------|
| `"{a-z}yy` | レジスタにヤンク |
| `"{a-z}p` | レジスタからペースト |

### ワードラップモード

`:set wrap`で有効化：
- 長い行が視覚的に折り返される
- `j`/`k`は論理行で移動
- `gj`/`gk`は表示行で移動

---

## ヒントとコツ

### 生産性向上のヒント

1. **ノーマルモードを基本に** - 入力時だけインサートモードに入り、すぐノーマルに戻る
2. **カウントを活用** - `5dd`は`dd`を5回押すより速い
3. **`.`を活用** - 直前の変更を1キーで繰り返せる
4. **モーションを学ぶ** - `dw`、`d$`、`d}` - 削除とモーションの組み合わせ

### よくあるワークフロー

**テキストをリストに変換：**
1. 行をビジュアル選択（`V`してから`j`）
2. `:`でコマンドモードに入る
3. 置換を使用（将来のバージョンで対応予定）

**簡単なフォーマット：**
- `~`で文字の大文字/小文字を切り替え
- `gUw`で単語を大文字に（ノーマルモード）
- `guw`で単語を小文字に（ノーマルモード）

### 設定

⚙️をクリックして設定にアクセス：
- **テーマ**: ライト / ダーク
- **フォントサイズ**: 12-24px
- **自動保存**: 間隔を設定可能
- **言語**: お好みの言語を選択

### Vimモードの切り替え

- `Ctrl+Shift+V`でVimモードと通常編集モードを切り替え
- 通常編集モード（NOVIM）ではモードなしで入力可能
- ツールバーのVIM/NOVIMボタンでも切り替え可能

---

## まとめ

mdvimの基本を学びました！覚えておくべきポイント：

1. **モードが基本** - コマンドはノーマル、入力はインサート
2. **モーションは強力** - オペレータと組み合わせて使う
3. **練習あるのみ** - Vimコマンドを使うほど速くなる

楽しい編集を！🚀
